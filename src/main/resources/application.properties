server.port=${SERVER_PORT:8080}

# ===== BASE DE DATOS =====
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/haidainversiones_llantas}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:llantas123}

# ✅ FLYWAY: reemplaza ddl-auto=update
# Flyway versiona el schema. Nunca más ddl-auto=update en producción.
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true

# validate = Hibernate verifica que las entidades coincidan con el schema de Flyway
# Si hay discrepancia, la app no arranca → fallo rápido y explícito
spring.jpa.hibernate.ddl-auto=update

spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.open-in-view=false

spring.application.name=haidainversiones-llantas

# ===== JWT =====
jwt.secret=${JWT_SECRET:HaidaInversionesLlantasSecretKey2026SuperSeguroParaJWTminimo64caracteres!!}
# ✅ Access token: 15 minutos (era 24 horas — reducido 96x)
jwt.access-expiration=${JWT_ACCESS_EXPIRATION:900000}
# ✅ Refresh token: 7 días
jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}

# ===== NEGOCIO =====
negocio.costo-envio=${COSTO_ENVIO:15.00}

# ===== CORS =====
app.frontend-url=${FRONTEND_URL:http://localhost:4200}

# ===== LOGGING =====
logging.level.org.springframework.web=${LOG_LEVEL_WEB:DEBUG}
logging.level.org.springframework.security=${LOG_LEVEL_SECURITY:INFO}
logging.level.com.haidainversiones=${LOG_LEVEL_APP:DEBUG}
logging.level.org.flywaydb=${LOG_LEVEL_FLYWAY:INFO}

# ===== PAGINACIÓN =====
spring.data.web.pageable.default-page-size=20
spring.data.web.pageable.max-page-size=100

# ===== CACHE =====
# Para producción con múltiples instancias → Redis:
#   spring.cache.type=redis
#   spring.data.redis.host=${REDIS_HOST:localhost}
spring.cache.type=simple

# ===== SQL INIT =====
# Flyway maneja el schema. data.sql solo para datos iniciales (roles, admin).
spring.sql.init.mode=always
spring.sql.init.schema-locations=
spring.jpa.defer-datasource-initialization=true
